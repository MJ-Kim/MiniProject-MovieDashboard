<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í”Œë«í¼ë³„ ì¸ê¸° ì˜í™” ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="container mt-4">
    <h1 class="text-center mb-4">ğŸ¬ í”Œë«í¼ë³„ ì¸ê¸° ì˜í™” ëŒ€ì‹œë³´ë“œ</h1>

    <!-- 1í–‰: í‰ì  TOP 10, ì¢‹ì•„ìš” TOP 10 -->
    <div class="row">
        <div class="col-md-6">
            <h3>â­ í‰ì  Top 10</h3>
            <ul class="list-group">
                {% for movie in top_rating %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ movie.title }}
                        <span class="badge bg-primary">{{ movie.max_rating }}</span>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <div class="col-md-6">
            <h3>ğŸ‘ ì¢‹ì•„ìš” Top 10</h3>
            <ul class="list-group">
                {% for movie in top_likes %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ movie.title }}
                        <span class="badge bg-success">{{ movie.max_likes }}</span>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <!-- 2í–‰: ë‚¨ì„±/ì—¬ì„± í‰ì  -->
    <div class="row mt-4">
        <div class="col-md-6">
            <h3>ğŸ‘¨ ë‚¨ì„± í‰ì  Top 10</h3>
            <ul class="list-group">
                {% for movie in top_male %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ movie.title }}
                        <span class="badge bg-info">{{ movie.max_rating }}</span>
                    </li>
                {% endfor %}
            </ul>
        </div>

        <div class="col-md-6">
            <h3>ğŸ‘© ì—¬ì„± í‰ì  Top 10</h3>
            <ul class="list-group">
                {% for movie in top_female %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ movie.title }}
                        <span class="badge bg-danger">{{ movie.max_rating }}</span>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <!-- 3í–‰: í”Œë«í¼ë³„ ì¥ë¥´ íŒŒì´ì°¨íŠ¸ -->
    <div class="row mt-5">
        <h3 class="text-center mb-3">ğŸ¿ í”Œë«í¼ë³„ ì¥ë¥´ ë¶„í¬</h3>
        <div class="row">
            {% for platform, genres in platform_genre_data.items %}
                <div class="col-md-3">
                    <canvas id="chart-{{ forloop.counter }}"></canvas>
                    <p class="text-center mt-2"><strong>{{ platform }}</strong></p>
                </div>
            {% endfor %}
        </div>
    </div>

    <script>
        let chartCount = 1;
        {% for platform, genres in platform_genre_data.items %}
            let ctx{{ forloop.counter }} = document.getElementById("chart-{{ forloop.counter }}").getContext("2d");
            new Chart(ctx{{ forloop.counter }}, {
                type: "pie",
                data: {
                    labels: [{% for g, c in genres.items %}"{{ g }}",{% endfor %}],
                    datasets: [{
                        data: [{% for g, c in genres.items %}{{ c }},{% endfor %}],
                        backgroundColor: [
                            "#FF6384","#36A2EB","#FFCE56","#4BC0C0",
                            "#9966FF","#FF9F40","#66FF66","#FF6699"
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: "bottom" },
                        title: { display: true, text: "{{ platform }} ì¥ë¥´ ë¶„í¬" }
                    }
                }
            });
        {% endfor %}
    </script>
</body>
</html>
